# SOC Lab – Splunk (Docker) + Synthetic Logs

A beginner-friendly **home SOC lab** that runs **Splunk Enterprise (trial)** in Docker and ingests **synthetic auth, web, and Sysmon-like logs**. Includes detections (SPL), a triage dashboard, and a log generator so you can practice threat hunting safely.

## Highlights
- Run **Splunk** via Docker (no installer/account needed).
- Generate **safe synthetic logs** (SSH brute-force, SQLi/LFI patterns, suspicious PowerShell/LSASS).
- Prebuilt **Dashboard Studio** triage board and **SPL detections**.
- Written for **Windows 11 Home**, but works on macOS/Linux with Docker too.

## Quickstart
```powershell
# 1) Start Splunk
docker compose up -d

# 2) Generate logs
python scripts\simulate_logs.py --quick

# 3) Open Splunk
# http://localhost:8000  (admin / ChangeMe123!)  ← change password after login
```

## Key Searches (SPL)
```spl
# Failed logins
index=main sourcetype=lab:auth action=failure

# Suspicious web
index=main sourcetype=lab:web (uri="*%27*" OR uri="*../../*" OR status>=500)

# Suspicious processes (PowerShell/LSASS)
index=main sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational 
(CommandLine="*EncodedCommand*" OR CommandLine="*-enc *" OR CommandLine="*lsass*")
```

## Project Structure
```
soc_starter_kit/
├─ docker-compose.yml
├─ README.md             # local setup guide
├─ spl/queries.spl       # detections to save/alert
├─ scripts/simulate_logs.py
├─ splunk-apps/
│  ├─ TA_lab_inputs/     # file monitors
│  └─ TA_lab_dashboards/ # dashboard JSON
└─ data/logs/            # synthetic logs land here
```

## FAQ: Where did the attack logs come from?
All logs are **synthetic** and generated by `scripts/simulate_logs.py`. They simulate realistic patterns without running malware.

## License
MIT
